#!/bin/bash
set -eu

if [[ $GENESIS_DEPLOY_RC == 0 ]]; then

      echo
  describe "#M{$GENESIS_ENVIRONMENT} Vault deployed!"
      echo

  if [[ -f "$GENESIS_PREDEPLOY_DATAFILE" ]] ; then
      echo "Unsealing the vault..."
    safe -T $GENESIS_ENVIRONMENT unseal < $GENESIS_PREDEPLOY_DATAFILE
  else
  describe "Unable to unseal the vault.  If this is a new deployment," \
           "you will need to initalize the vault first.  To do so, run" \
           "" \
           "  #G{genesis do $GENESIS_ENVIRONMENT -- init}" \
           "" \
           "If this was not the initial deployment of the" \
           "Vault, you will need to unseal it, via" \
           "" \
           "  #G{genesis do $GENESIS_ENVIRONMENT -- unseal}" \
  fi
  describe "" \
           "For details about the deployment, run" \
           "" \
           "  #G{genesis info $GENESIS_ENVIRONMENT}" \
           ""
fi
